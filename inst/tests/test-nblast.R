context("Test fc_nblast")

oldbigmatdir <- getOption('flycircuit.bigmatdir')
options('flycircuit.bigmatdir' = '~/projects/ChiangReanalysis/data/bigmatrix/')

test_that("fc_nblast returns correct scores", {
  scores <- fc_nblast(fc_gene_name(1:10), fc_gene_name(11:20))
  expectedscores <- structure(c(-13399.3222560619, -34248.2801558364, -29200.5258989013, -39054.6604773039, -39351.0839143571, -10559.9347711654, -21051.1069253432, -41377.7089382557, -35032.5417295928, 11692.5753862641, -3911.72092054621, -7263.94900789181, 1527.30846848991, -6874.58519390909, -5071.85196107618, -6969.33711759282, -6987.08470161138, -4412.71978033868, -7275.01153392795, -1253.21724479395, -11855.7626888472, -12192.0250723216, -12131.7990380955, -12193.1749423695, -1957.55968475551, -12198.8957851403, -9936.65640089481, -4750.11207992382, -12208.1487266731, -301.446835931381, -9822.20582186732, -4833.23187474757, -15817.6298326217, -14685.7138963413, -15684.1856197638, 138.139936396755, -6633.95988174061, -15828.7720496744, -3797.52617204736, -423.698870786826, -18130.1139716156, -23389.3585292915, -5812.52537088335, -11998.7303511994, -21570.4138003094, -23409.4405692232, -20046.8526569597, -20190.3645067463, -23386.4262055898, -11716.8790216724, -2615.13031445459, -12845.6360660076, -3399.91527303601, -2100.37020140282, -12849.854477695, -12278.4251427259, -4551.81523927154, -12856.2346912123, -12843.4506778003, -2248.86545221857, -17270.3192428511, -51509.3901921684, -30930.1175981234, -51242.1705263474, -57825.8276526476, -30882.8240129614, -36270.9435780591, -58451.6102454153, -51743.318766937, 1005.01527403501, -8216.82037818799, -1485.36402460836, -12333.2362677221, -11217.1931382695, -11873.2612809813, -391.906823821272, -5570.49186772987, -12344.9068674575, -2568.26537528147, -1081.68488589019, 37628.5155329889, -43353.0308420637, -43436.9588524365, -18372.2583003561, -43667.2548942318, -14420.1803160903, 16981.2785287369, -46097.883279421, -43512.9595120649, -1018.39742472699, -3250.94479909638, -6060.35462659178, 343.099590019471, -5932.30128837107, -2147.14378225377, -5483.94140033321, -5902.21151636577, -2946.63275969904, -6061.9479011002, -1399.56634135748), .Dim = c(10L, 10L), .Dimnames = list(c("FruMARCM-M002590_seg002", "FruMARCM-M002591_seg001", "FruMARCM-M002591_seg002", "FruMARCM-M002194_seg001", "FruMARCM-M002196_seg001", "FruMARCM-M002198_seg001", "FruMARCM-M002200_seg001", "FruMARCM-M002204_seg001", "FruMARCM-M002206_seg001", "FruMARCM-M002213_seg001"), c("FruMARCM-M002262_seg001", "FruMARCM-M002262_seg002", "FruMARCM-M002278_seg001", "FruMARCM-M002287_seg001", "FruMARCM-M002507_seg001", "FruMARCM-M002522_seg001", "FruMARCM-M002578_seg001", "FruMARCM-M002578_seg002", "FruMARCM-M002579_seg001", "FruMARCM-M002579_seg002")))
  expect_equal(scores, expectedscores)
})

options('flycircuit.bigmatdir' = oldbigmatdir)
